\setchapterimage{seaside}
\setchapterpreamble[u]{\margintoc}
\chapter{Instruction Set Architecture (ISA)}
\labch{isa}

%
% Key concepts and abilities
%==============================================================================
\begin{kaobox}[frametitle=In This Chapter]
you will learn
\begin{itemize}
	\item First topic
	\item Second topic
        \item Third topic
\end{itemize}

you will be able to
\begin{itemize}
        \item Task one
        \item Task two
        \item Task three
\end{itemize}
\end{kaobox}

% Introductory paragraph goes here
\blindtext

%
% Section: ISA Explained
%==============================================================================
\section{ISA Explained}
Explain what an ISA is.

%
% Section: Instruction cycle
%==============================================================================
\section{Instruction cycle}
\blindtext

%
% Section: Instruction Format
%==============================================================================
\section{Instruction Format}

%
% Section: Instruction Timing
%==============================================================================
\section{Instruction Timing}
\blindtext

\begin{figure}[hbt!]
\begin{tikzpicture}[
    myline/.style={draw=green!40!black, thick},
    box/.style={myline, minimum height=1cm, minimum width=1cm, font=\sffamily, inner sep=.3333em}, >=Stealth]

    \matrix (CPU) [matrix of nodes, inner ysep=3mm, nodes=box, myline, column sep=1mm]
        {|(CU)|CU & |[draw=none]|CPU & |(ALU)| ALU \\};
    \node[box, above left=5mm of CPU] (input) {INPUT};

    \node[box, below left=5mm of CPU] (output) {OUTPUT};
    \node[box, at=(CPU|-output)] (memory) {MEMORY};
    \node[box, below left=5mm of memory, anchor=north] (storage) {STORAGE};

    \draw[<->, myline] (storage)-|(memory);
    \draw[->,myline] (input)-|(CU);
    \draw[->,myline] (CU)|-(output);

    \draw[<->, myline] ($(CU.south west)!.2!(CU.south east)$) coordinate (aux)--(aux|-storage.north);
    \draw[<->, myline] ($(CU.south west)!.8!(CU.south east)$) coordinate (aux)--(aux|-memory.north);
    \draw[<->, myline] ($(ALU.south west)!.2!(ALU.south east)$) coordinate (aux)--(aux|-memory.north);
\end{tikzpicture}\caption[Timing diagram]{This is an example timing diagram that will be replaced by the real thing.}
\end{figure}

\blindtext
\blindtext

\begin{figure}[hbt!]
\begin{tikztimingtable}
    RESET & l 29{H} \\
    Clock & 3{10{C}} \\
    Clock & 3{10{C}} \\
    Name & 3{hLLLLh} \\
    Signal & 3{z8D{Text}z} \\
    Signal & {z8D{Setup 00}z} {z8D{Setup 01}z} {z8D{Setup 10}z} {z8D{Setup 11}z} \\
    Signal & {z8D{PC> ,>MAR}z} {z8D{PM> ,>IR ,PC++}z} {z8D{PC> ,>MAR}z} {z8D{LC=IR[]}z} \\
\end{tikztimingtable}
\caption[Timing diagram]{This is an example timing diagram that will be replaced by the real thing.}
\end{figure}



\begin{figure*}[h!]
\begin{lstlisting}
        _______________________________________________________________________
RESET _/       

           _______         _______         _______         _______         ____
 CLK  ____/       \_______/       \_______/       \_______/       \_______/    
      ... | Execute 00    | Execute 01    | Execute 10    | Execute 11   |
          |  PC> ,>MAR    | PM> ,>IR ,PC++| PC> ,>MAR     | CL=IR[]      | ...
      ____         _______         _______         _______         _______     
~CLK      \_______/       \_______/       \_______/       \_______/       \____
  ... Setup 00    | Setup 01      | Setup 10      | Setup 11      | ...
      PC> ,>MAR   | PM> ,>IR ,PC++| PC> ,>MAR     | CL=IR[]       |
\end{lstlisting}
\caption[Timing chart]{Instructions are executed. The contyrol logic is configured in between each step. Timing chart.}
\end{figure*}

























